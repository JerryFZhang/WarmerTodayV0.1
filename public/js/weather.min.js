function showPosition(t){var r,o;r=parseFloat(JSON.stringify(t.coords.latitude)),o=parseFloat(JSON.stringify(t.coords.longitude)),$("p.location").replaceWith(""),getWeather(r,o)}function convertToCelcius(t){var r=5*(t-32)/9;return r.toFixed(0)}function getTimeArray(){for(var t=(new Date).getHours(),r=[],o=[],a=0;a<24;a++){var e=a+t;e>24?r[a]=t+a-24:r[a]=t+a}for(var a=0;a<24;a++)switch(!0){case r[a]>0&&r[a]<12:o[a]=r[a]+"am";break;case 12==r[a]:o[a]="12pm";break;case r[a]>12&&r[a]<24:o[a]=r[a]-12+"pm";break;case 24==r[a]:o[a]="12am"}return o}function loadChart(t,r){var o=document.getElementById("c").getContext("2d"),a=getTimeArray(),e={labels:a,datasets:[{label:"My First dataset",fillColor:"rgba(220,220,220,0.2)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:t},{label:"My Second dataset",fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:r}]};new Chart(o).Line(e)}function parseHourlyData(t){for(var r=[],o=0;o<t.length;o++){var a=t[o].time,e=(new Date(1e3*a),parseFloat(t[o].apparentTemperature));r[o]=convertToCelcius(e)}return r}function getWeather(t,r){var o=[],a=[];$.post("/current",{lat:t,lng:r},function(t){t=JSON.parse(t);var r=t.hourly.data;o=parseHourlyData(r),loadChart(o,a),$("p.inner").replaceWith("<h2>"+t.currently.summary+"</h2><br><h2>"+convertToCelcius(t.currently.temperature)+" CÂº</h2><br>")}),$.post("/old",{lat:t,lng:r},function(t){t=JSON.parse(t);var r=t.hourly.data;a=parseHourlyData(r),$("p.inner2").replaceWith("")})}navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition):$("p.location").replaceWith("Geolocation is not supported by this browser.");